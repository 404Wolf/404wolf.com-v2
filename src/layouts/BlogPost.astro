---
import { Image } from "astro:assets";
import type { CollectionEntry } from "astro:content";
import "../styles/markdown.css";
import "../styles/global.css";
import BaseLayout from "./BaseLayout.astro";
import Tile from "../components/Tile.astro";
import Tag from "../components/Tag.astro";

type Props = CollectionEntry<"blog">["data"];

const { title, covers, tags, description } = Astro.props;
const cover =
  covers && covers.length > 0
    ? covers[Math.floor(Math.random() * covers.length)]
    : null;
---

<BaseLayout>
  <div class="bg-slate-400 max-w-5xl mx-auto py-3 px-6 rounded-xl">
    <div class="mt-3 overflow-visible">
      <Tile title="Overview" direction="right" className="mb-6">
        <div class="h-fit overflow-auto">
          {
            cover && (
              <div class="relative pointer-events-none rounded-xl w-2/5 sm:w-1/4 sm:mt-4 sm:ml-2 float-right">
                <div class="max-h-60 overflow-clip border-4 border-slate-500 rounded-xl">
                  <Image
                    width={400}
                    height={400}
                    src={cover}
                    class="rounded-xl scale-105"
                    alt={`${title}'s cover image`}
                  />
                </div>
              </div>
            )
          }
          <div class="-mt-1 mb-2 sm:mb-1 text-lg sm:text-xl">
            {description || title}
          </div>
        </div>

        {
          tags && (
            <div class="brightness-125 absolute -right-4 -bottom-2 z-50">
              <div class="flex flex-wrap gap-2">
                {tags.map((tag) => (
                  <Tag contents={tag} />
                ))}
              </div>
            </div>
          )
        }
      </Tile>

      <div class="m-6"></div>

      <Tile title={title} direction="right">
        <div class="-mt-4 xl:px-[14%] markdown">
          <slot />
        </div>
      </Tile>
    </div>
  </div>
</BaseLayout>
